<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¨˜æ†¶å¡ç‰‡é…å°éŠæˆ²</title>
    <style>
        @font-face {
            font-family: 'è¯åº·ç«¥ç«¥é«”'; /* å­—é«”åç¨± */
            src: url('fonts/è¯åº·ç«¥ç«¥é«”.ttf') format('truetype'); /* å­—é«”æª”æ¡ˆè·¯å¾‘ */
        }
        body {
            font-family: 'è¯åº·ç«¥ç«¥é«”', Arial, sans-serif; /* è¨­ç½®å…¨å±€å­—é«” */
            background-color: #f0f8ff; /* è¨­ç½®èƒŒæ™¯è‰² */
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            font-weight: bold; /* å…¨å±€å­—é«”åŠ ç²— */
        }

        h2 {
            font-size: 28px;
            color: #ff4500; /* è¨­ç½®æ¨™é¡Œé¡è‰² */
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px #aaa; /* å¢åŠ é™°å½±æ•ˆæœ */
        }

        #timer {
            font-size: 24px;
            margin-bottom: 20px;
            color: #333;
        }

        #matchedPairsDisplay {
            font-size: 20px;
            margin-bottom: 20px;
            color: #333;
        }

        label, select, button {
            margin: 10px;
            font-size: 18px;
            padding: 5px;
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(10, 1fr); /* æ¯è¡Œé¡¯ç¤º10å¼µå¡ç‰‡ */
            gap: 10px;
            margin-top: 20px;
        }

        .card-wrapper {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .card {
            width: 60px;
            height: 80px;
            background-color: #4682b4;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            cursor: pointer;
            border-radius: 5px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .card.matched {
            background-color: #32cd32;
            cursor: default;
        }

        .coordinate {
            font-size: 12px;
            margin-bottom: 5px;
            color: #333;
        }

        footer {
            margin-top: 20px;
            font-size: 14px;
            color: #888;
        }

        footer a {
            color: #4682b4;
            text-decoration: none;
            font-weight: bold;
        }

        footer a:hover {
            text-decoration: underline;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4682b4;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-family: 'è¯åº·ç«¥ç«¥é«”', Arial, sans-serif;
            font-weight: bold;
        }

        button:hover {
            background-color: #ff6347;
        }

        /* å›åˆ°ä¸Šä¸€é æŒ‰éˆ•çš„æ¨£å¼ */
        .back-button {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4682b4;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* å¢åŠ æŒ‰éˆå½±æ•ˆæœ */
            transition: background-color 0.3s ease;
            font-weight: bold; /* ä½¿æŒ‰éˆå­—é«”åŠ ç²— */
            font-family: 'è¯åº·ç«¥ç«¥é«”', sans-serif; /* å¯é¸ï¼Œè¨­å®šå­—é«” */
        }
        .back-button:hover {
            background-color: #ff6347; /* æ”¹è®Šæ‡¸åœæ™‚çš„èƒŒæ™¯è‰² */
        }
    </style>
</head>
<body>
    <h2>è¨˜æ†¶å¡ç‰‡é…å°éŠæˆ²</h2>
    <p id="timer">00:00:00</p> <!-- è¨ˆæ™‚å™¨é¡¯ç¤º -->
    <p id="matchedPairsDisplay">å·²å®Œæˆé…å°ï¼š0 çµ„</p> <!-- å·²å®Œæˆé…å°é¡¯ç¤ºå™¨ -->
    <label for="difficulty">é¸æ“‡é›£åº¦ï¼š</label>
    <select id="difficulty">
        <option value="easy">å®¹æ˜“</option>
        <option value="normal">æ™®é€š</option>
        <option value="hard">å›°é›£</option>
        <option value="nightmare">æƒ¡å¤¢</option>
    </select>
    <button id="startGame">é–‹å§‹éŠæˆ²</button>

    <div id="gameBoard" class="game-board"></div>

    <!-- å›åˆ°ä¸Šä¸€é æŒ‰éˆ• -->
    <button class="back-button" onclick="goBack()">å›åˆ°ä¸Šä¸€é </button>

    <footer>
        <p>éŠæˆ²ç”± <a href="#">æ¿°æ¿°çš„å°å±‹</a> æä¾›</p>
    </footer>

    <script>
        // å…¨å±€è®Šé‡å®£å‘Š
        let cards = [];
        let firstCard = null;
        let secondCard = null;
        let matchedPairs = 0; // ç•¶å‰å·²é…å°çš„å¡ç‰‡çµ„æ•¸
        let shuffleCounter = 0; // è¨˜éŒ„å·²è§¸ç™¼æ´—ç‰Œçš„æ¬¡æ•¸
        let timer;
        let isFlipping = false; // é˜²æ­¢åŒæ™‚ç¿»å¤šå¼µå¡ç‰‡
        let startTime;
        let timerInterval;
        let totalPairs = 0;

        document.getElementById('startGame').addEventListener('click', startGame);

        function startGame() {
            clearTimeout(timer); // æ¸…é™¤æƒ¡å¤¢æ¨¡å¼çš„é‡æ–°æ´—ç‰Œè¨ˆæ™‚
            clearInterval(timerInterval); // æ¸…é™¤ä¹‹å‰çš„è¨ˆæ™‚å™¨
            resetTimer(); // é‡ç½®è¨ˆæ™‚å™¨é¡¯ç¤º
            matchedPairs = 0; // é‡ç½®é…å°è¨ˆæ•¸
            document.getElementById('matchedPairsDisplay').textContent = `å·²å®Œæˆé…å°ï¼š0 çµ„`;
            shuffleCounter = 0; // é‡ç½®æ´—ç‰Œè¨ˆæ•¸
            firstCard = null;
            secondCard = null;
            isFlipping = false;
            startTime = null; // é‡ç½®é–‹å§‹æ™‚é–“
            const difficulty = document.getElementById('difficulty').value;
            totalPairs = difficulties[difficulty];
            createCards(totalPairs);
            shuffleCards();
            displayCards();
        }

        const difficulties = {
            easy: 10,
            normal: 30,
            hard: 50,
            nightmare: 100
        };

        function createCards(pairCount) { 
            cards = [];
            for (let i = 1; i <= pairCount; i++) {
                cards.push(i, i);
            }
        }

        function shuffleCards() {
            cards.sort(() => Math.random() - 0.5);
        }

        function displayCards() {
            const gameBoard = document.getElementById('gameBoard');
            gameBoard.innerHTML = '';
            const columns = 10; // æ¯è¡Œé¡¯ç¤º10å¼µå¡ç‰‡

            cards.forEach((value, index) => {
                const cardWrapper = document.createElement('div');
                cardWrapper.classList.add('card-wrapper');

                const coordinate = document.createElement('div');
                const x = index % columns + 1;
                const y = Math.floor(index / columns) + 1;
                coordinate.textContent = `(${x}, ${y})`;
                coordinate.classList.add('coordinate');

                const card = document.createElement('div');
                card.classList.add('card');
                card.dataset.value = value;
                card.dataset.index = index;
                card.addEventListener('click', flipCard);
                card.textContent = ''; // åˆå§‹åŒ–æ™‚éš±è—å¡ç‰‡çš„å€¼

                cardWrapper.appendChild(coordinate);
                cardWrapper.appendChild(card);
                gameBoard.appendChild(cardWrapper);
            });
        }

        function flipCard(event) {
            if (isFlipping) return;
            const clickedCard = event.target;
            if (clickedCard.classList.contains('matched') || clickedCard === firstCard) {
                return;
            }

            if (!startTime) {
                startTime = Date.now();
                startTimer();
            }

            const emojis = [
                'ğŸ˜€', 'ğŸ˜‚', 'ğŸ˜', 'ğŸ’¡', 'ğŸŒŸ', 'ğŸ€', 'ğŸ±', 'ğŸš€', 'ğŸ•', 'ğŸ‰',
                'ğŸ˜ƒ', 'ğŸ˜„', 'ğŸ˜…', 'ğŸ˜†', 'ğŸ˜‰', 'ğŸ˜Š', 'ğŸ˜‹', 'ğŸ˜', 'ğŸ˜˜', 'ğŸ˜—',
                'ğŸ˜™', 'ğŸ˜š', 'ğŸ˜œ', 'ğŸ˜', 'ğŸ˜›', 'ğŸ˜º', 'ğŸ˜¸', 'ğŸ˜¹', 'ğŸ˜»', 'ğŸ˜¼',
                'ğŸ˜½', 'ğŸ™€', 'ğŸ˜¿', 'ğŸ˜¾', 'ğŸ‘¶', 'ğŸ‘¦', 'ğŸ‘§', 'ğŸ‘¨', 'ğŸ‘©', 'ğŸ‘´',
                'ğŸ‘µ', 'ğŸ‘®', 'ğŸ‘·', 'ğŸ’‚', 'ğŸ‘¼', 'ğŸ…', 'ğŸ‘»', 'ğŸ‘½', 'ğŸ‘¾', 'ğŸ’©',
                'ğŸ˜ˆ', 'ğŸ‘¿', 'ğŸ‘¹', 'ğŸ‘º', 'ğŸ’€', 'â˜ ', 'ğŸ‘°', 'ğŸ‘¸', 'ğŸ‘³', 'ğŸ“',
                'ğŸ‘‘', 'ğŸ‘’', 'ğŸ‘“', 'ğŸ©', 'ğŸ‘ ', 'ğŸ‘¡', 'ğŸ‘¢', 'ğŸ‘', 'ğŸ‘Ÿ', 'ğŸ¶',
                'ğŸ±', 'ğŸ­', 'ğŸ¹', 'ğŸ°', 'ğŸ¦Š', 'ğŸ»', 'ğŸ¼', 'ğŸ¨', 'ğŸ¯', 'ğŸ¦',
                'ğŸ®', 'ğŸ·', 'ğŸ½', 'ğŸ¸', 'ğŸµ', 'ğŸ™ˆ', 'ğŸ™‰', 'ğŸ™Š', 'ğŸ’', 'ğŸ”',
                'ğŸ§', 'ğŸ¦', 'ğŸ¤', 'ğŸ£', 'ğŸ¥', 'ğŸ¦†', 'ğŸ¦…', 'ğŸ¦‰', 'ğŸ¦‡', 'ğŸº'
            ];
            clickedCard.textContent = emojis[clickedCard.dataset.value % emojis.length];
            
            if (!firstCard) {
                firstCard = clickedCard;
            } else if (!secondCard) {
                secondCard = clickedCard;
                isFlipping = true;
                checkForMatch();
            }
        }

        function checkForMatch() {
            if (firstCard.dataset.value === secondCard.dataset.value) {
                firstCard.classList.add('matched');
                secondCard.classList.add('matched');
                matchedPairs++;
                document.getElementById('matchedPairsDisplay').textContent = `å·²å®Œæˆé…å°ï¼š${matchedPairs} çµ„`;
                resetCards();
                
                if (matchedPairs === totalPairs) {
                    clearInterval(timerInterval); // é…å°å®Œæˆå¾Œåœæ­¢è¨ˆæ™‚
                    alert('æ­å–œï¼ä½ å®Œæˆäº†æ‰€æœ‰é…å°ï¼');
                } else if (matchedPairs % 10 === 0 && matchedPairs / 10 > shuffleCounter) {
                    // æ¯æˆåŠŸé…å°10çµ„å¾Œé€²è¡Œæ´—ç‰Œï¼Œä¸”åªæ´—ç‰Œä¸€æ¬¡
                    shuffleCounter++;
                    reshuffleUnmatched();
                }
                
                isFlipping = false; // åŒ¹é…å®Œæˆï¼Œå…è®¸ç¿»å¼€æ–°å¡ç‰‡
            } else {
                setTimeout(() => {
                    firstCard.textContent = '';
                    secondCard.textContent = '';
                    resetCards();
                    isFlipping = false; // åŒ¹é…å¤±æ•—å¾Œå…è¨±ç¿»é–‹æ–°å¡ç‰‡
                }, 1000);
            }
        }

        function resetCards() {
            firstCard = null;
            secondCard = null;
        }

        function reshuffleUnmatched() {
            const unmatchedCards = Array.from(document.querySelectorAll('.card:not(.matched)'));
            const unmatchedValues = unmatchedCards.map(card => card.dataset.value);
            shuffleArray(unmatchedValues);
            unmatchedCards.forEach((card, index) => {
                card.textContent = '';
                card.dataset.value = unmatchedValues[index];
            });
            alert('å¡ç‰‡é‡æ–°æ´—ç‰Œï¼'); // æç¤ºç©å®¶å¡ç‰‡å·²é‡æ–°æ´—ç‰Œ
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                const elapsedTime = Date.now() - startTime;
                document.getElementById('timer').textContent = formatTime(elapsedTime);
            }, 1000);
        }

        function resetTimer() {
            document.getElementById('timer').textContent = '00:00:00';
        }

        function formatTime(ms) {
            const totalSeconds = Math.floor(ms / 1000);
            const hours = String(Math.floor(totalSeconds / 3600)).padStart(2, '0');
            const minutes = String(Math.floor((totalSeconds % 3600) / 60)).padStart(2, '0');
            const seconds = String(totalSeconds % 60).padStart(2, '0');
            return `${hours}:${minutes}:${seconds}`;
        }

        // å›åˆ°ä¸Šä¸€é çš„å‡½æ•¸
        function goBack() {
            window.history.back();
        }
    </script>
</body>
</html>
